{"ast":null,"code":"module.exports = class Spline {\n  constructor(xs, ys) {\n    this.xs = xs;\n    this.ys = ys;\n    this.ks = this.getNaturalKs(new Float64Array(this.xs.length));\n  }\n\n  getNaturalKs(ks) {\n    const n = this.xs.length - 1;\n    const A = zerosMat(n + 1, n + 2);\n\n    for (let i = 1; i < n; i++ // rows\n    ) {\n      A[i][i - 1] = 1 / (this.xs[i] - this.xs[i - 1]);\n      A[i][i] = 2 * (1 / (this.xs[i] - this.xs[i - 1]) + 1 / (this.xs[i + 1] - this.xs[i]));\n      A[i][i + 1] = 1 / (this.xs[i + 1] - this.xs[i]);\n      A[i][n + 1] = 3 * ((this.ys[i] - this.ys[i - 1]) / ((this.xs[i] - this.xs[i - 1]) * (this.xs[i] - this.xs[i - 1])) + (this.ys[i + 1] - this.ys[i]) / ((this.xs[i + 1] - this.xs[i]) * (this.xs[i + 1] - this.xs[i])));\n    }\n\n    A[0][0] = 2 / (this.xs[1] - this.xs[0]);\n    A[0][1] = 1 / (this.xs[1] - this.xs[0]);\n    A[0][n + 1] = 3 * (this.ys[1] - this.ys[0]) / ((this.xs[1] - this.xs[0]) * (this.xs[1] - this.xs[0]));\n    A[n][n - 1] = 1 / (this.xs[n] - this.xs[n - 1]);\n    A[n][n] = 2 / (this.xs[n] - this.xs[n - 1]);\n    A[n][n + 1] = 3 * (this.ys[n] - this.ys[n - 1]) / ((this.xs[n] - this.xs[n - 1]) * (this.xs[n] - this.xs[n - 1]));\n    return solve(A, ks);\n  }\n  /**\n   * inspired by https://stackoverflow.com/a/40850313/4417327\n   */\n\n\n  getIndexBefore(target) {\n    let low = 0;\n    let high = this.xs.length;\n    let mid = 0;\n\n    while (low < high) {\n      mid = Math.floor((low + high) / 2);\n\n      if (this.xs[mid] < target && mid !== low) {\n        low = mid;\n      } else if (this.xs[mid] >= target && mid !== high) {\n        high = mid;\n      } else {\n        high = low;\n      }\n    }\n\n    return low + 1;\n  }\n\n  at(x) {\n    let i = this.getIndexBefore(x);\n    const t = (x - this.xs[i - 1]) / (this.xs[i] - this.xs[i - 1]);\n    const a = this.ks[i - 1] * (this.xs[i] - this.xs[i - 1]) - (this.ys[i] - this.ys[i - 1]);\n    const b = -this.ks[i] * (this.xs[i] - this.xs[i - 1]) + (this.ys[i] - this.ys[i - 1]);\n    const q = (1 - t) * this.ys[i - 1] + t * this.ys[i] + t * (1 - t) * (a * (1 - t) + b * t);\n    return q;\n  }\n\n};\n\nfunction solve(A, ks) {\n  const m = A.length;\n  let h = 0;\n  let k = 0;\n\n  while (h < m && k <= m) {\n    let i_max = 0;\n    let max = -Infinity;\n\n    for (let i = h; i < m; i++) {\n      const v = Math.abs(A[i][k]);\n\n      if (v > max) {\n        i_max = i;\n        max = v;\n      }\n    }\n\n    if (A[i_max][k] === 0) {\n      k++;\n    } else {\n      swapRows(A, h, i_max);\n\n      for (let i = h + 1; i < m; i++) {\n        const f = A[i][k] / A[h][k];\n        A[i][k] = 0;\n\n        for (let j = k + 1; j <= m; j++) A[i][j] -= A[h][j] * f;\n      }\n\n      h++;\n      k++;\n    }\n  }\n\n  for (let i = m - 1; i >= 0; i-- // rows = columns\n  ) {\n    var v = 0;\n\n    if (A[i][i]) {\n      v = A[i][m] / A[i][i];\n    }\n\n    ks[i] = v;\n\n    for (let j = i - 1; j >= 0; j-- // rows\n    ) {\n      A[j][m] -= A[j][i] * v;\n      A[j][i] = 0;\n    }\n  }\n\n  return ks;\n}\n\nfunction zerosMat(r, c) {\n  const A = [];\n\n  for (let i = 0; i < r; i++) A.push(new Float64Array(c));\n\n  return A;\n}\n\nfunction swapRows(m, k, l) {\n  let p = m[k];\n  m[k] = m[l];\n  m[l] = p;\n}","map":{"version":3,"sources":["C:/Users/outuy/Desktop/Web_Numer-main/node_modules/cubic-spline/index.js"],"names":["module","exports","Spline","constructor","xs","ys","ks","getNaturalKs","Float64Array","length","n","A","zerosMat","i","solve","getIndexBefore","target","low","high","mid","Math","floor","at","x","t","a","b","q","m","h","k","i_max","max","Infinity","v","abs","swapRows","f","j","r","c","push","l","p"],"mappings":"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","sourcesContent":["module.exports = class Spline {\n  constructor(xs, ys) {\n    this.xs = xs;\n    this.ys = ys;\n    this.ks = this.getNaturalKs(new Float64Array(this.xs.length));\n  }\n\n  getNaturalKs(ks) {\n    const n = this.xs.length - 1;\n    const A = zerosMat(n + 1, n + 2);\n\n    for (\n      let i = 1;\n      i < n;\n      i++ // rows\n    ) {\n      A[i][i - 1] = 1 / (this.xs[i] - this.xs[i - 1]);\n      A[i][i] =\n        2 *\n        (1 / (this.xs[i] - this.xs[i - 1]) + 1 / (this.xs[i + 1] - this.xs[i]));\n      A[i][i + 1] = 1 / (this.xs[i + 1] - this.xs[i]);\n      A[i][n + 1] =\n        3 *\n        ((this.ys[i] - this.ys[i - 1]) /\n          ((this.xs[i] - this.xs[i - 1]) * (this.xs[i] - this.xs[i - 1])) +\n          (this.ys[i + 1] - this.ys[i]) /\n            ((this.xs[i + 1] - this.xs[i]) * (this.xs[i + 1] - this.xs[i])));\n    }\n\n    A[0][0] = 2 / (this.xs[1] - this.xs[0]);\n    A[0][1] = 1 / (this.xs[1] - this.xs[0]);\n    A[0][n + 1] =\n      (3 * (this.ys[1] - this.ys[0])) /\n      ((this.xs[1] - this.xs[0]) * (this.xs[1] - this.xs[0]));\n\n    A[n][n - 1] = 1 / (this.xs[n] - this.xs[n - 1]);\n    A[n][n] = 2 / (this.xs[n] - this.xs[n - 1]);\n    A[n][n + 1] =\n      (3 * (this.ys[n] - this.ys[n - 1])) /\n      ((this.xs[n] - this.xs[n - 1]) * (this.xs[n] - this.xs[n - 1]));\n\n    return solve(A, ks);\n  }\n\n  /**\n   * inspired by https://stackoverflow.com/a/40850313/4417327\n   */\n  getIndexBefore(target) {\n    let low = 0;\n    let high = this.xs.length;\n    let mid = 0;\n    while (low < high) {\n      mid = Math.floor((low + high) / 2);\n      if (this.xs[mid] < target && mid !== low) {\n        low = mid;\n      } else if (this.xs[mid] >= target && mid !== high) {\n        high = mid;\n      } else {\n        high = low;\n      }\n    }\n    return low + 1;\n  }\n\n  at(x) {\n    let i = this.getIndexBefore(x);\n    const t = (x - this.xs[i - 1]) / (this.xs[i] - this.xs[i - 1]);\n    const a =\n      this.ks[i - 1] * (this.xs[i] - this.xs[i - 1]) -\n      (this.ys[i] - this.ys[i - 1]);\n    const b =\n      -this.ks[i] * (this.xs[i] - this.xs[i - 1]) +\n      (this.ys[i] - this.ys[i - 1]);\n    const q =\n      (1 - t) * this.ys[i - 1] +\n      t * this.ys[i] +\n      t * (1 - t) * (a * (1 - t) + b * t);\n    return q;\n  }\n};\n\nfunction solve(A, ks) {\n  const m = A.length;\n  let h = 0;\n  let k = 0;\n  while (h < m && k <= m) {\n    let i_max = 0;\n    let max = -Infinity;\n    for (let i = h; i < m; i++) {\n      const v = Math.abs(A[i][k]);\n      if (v > max) {\n        i_max = i;\n        max = v;\n      }\n    }\n\n    if (A[i_max][k] === 0) {\n      k++;\n    } else {\n      swapRows(A, h, i_max);\n      for (let i = h + 1; i < m; i++) {\n        const f = A[i][k] / A[h][k];\n        A[i][k] = 0;\n        for (let j = k + 1; j <= m; j++) A[i][j] -= A[h][j] * f;\n      }\n      h++;\n      k++;\n    }\n  }\n\n  for (\n    let i = m - 1;\n    i >= 0;\n    i-- // rows = columns\n  ) {\n    var v = 0;\n    if (A[i][i]) {\n      v = A[i][m] / A[i][i];\n    }\n    ks[i] = v;\n    for (\n      let j = i - 1;\n      j >= 0;\n      j-- // rows\n    ) {\n      A[j][m] -= A[j][i] * v;\n      A[j][i] = 0;\n    }\n  }\n  return ks;\n}\n\nfunction zerosMat(r, c) {\n  const A = [];\n  for (let i = 0; i < r; i++) A.push(new Float64Array(c));\n  return A;\n}\n\nfunction swapRows(m, k, l) {\n  let p = m[k];\n  m[k] = m[l];\n  m[l] = p;\n}\n"]},"metadata":{},"sourceType":"script"}